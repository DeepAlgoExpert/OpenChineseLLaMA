[**ä¸­æ–‡**](./README.md) | [**English**](./README_EN.md)

# Open-Chinese-LLaMA-7B-Patch

æœ¬é¡¹ç›®ä¸ºåŸºäº [LLaMA](https://github.com/facebookresearch/llama)-7B ç»è¿‡ **ä¸­æ–‡æ•°æ®é›†äºŒæ¬¡é¢„è®­ç»ƒ** äº§ç”Ÿçš„ **ä¸­æ–‡å¤§è¯­è¨€æ¨¡å‹åŸºåº§**ã€‚

æœ¬é¡¹ç›®ä»£ç ä¾èµ–äº [OpenLMLab/collie](https://github.com/OpenLMLab/collie)ï¼Œè¯·é€šè¿‡å¦‚ä¸‹å‘½ä»¤å®‰è£…ï¼š

```bash

pip install git+https://github.com/OpenLMLab/collie.git

```

## ä½¿ç”¨

ç”±äº [LLaMA](https://github.com/facebookresearch/llama)-7B æœªå¼€æºå®˜æ–¹æƒé‡ï¼Œæœ¬æ¬¡å‘å¸ƒçš„æ¨¡å‹ä¸º **è¡¥ä¸** ç±»å‹ï¼Œéœ€é…åˆåŸå§‹å®˜æ–¹æƒé‡æ‰å¯ä»¥ä½¿ç”¨ã€‚

æ‚¨å¯ä»¥é€šè¿‡ `tools/patch_model.py` æ¥å®‰è£… **è¡¥ä¸**ï¼Œä¾‹å¦‚ï¼š

```bash

python tools/patch_model.py --base_model <path_or_name_to_original_model>
                            --patch_model openlmlab/open-chinese-llama-7b-patch
                            --base_model_format <hf_or_raw>

```

**è¡¥ä¸** å®‰è£…ä¸ºåŸåœ°å®‰è£…ï¼Œå³å®‰è£…åçš„ `patch` å³ä¸ºå®Œæ•´ç‰ˆ `hf` æ ¼å¼çš„æƒé‡ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `transformers` åŠ è½½æ¨¡å‹ã€‚

## é€šè¿‡å‘½ä»¤è¡Œå¿«é€Ÿä½“éªŒ

ç»è¿‡ **patch** çš„æ¨¡å‹å¯ä»¥è¢« `transformers` è½»æ¾åŠ è½½ã€‚ä¸ºäº†æ–¹ä¾¿å¿«é€Ÿä½“éªŒæ•ˆæœï¼Œæˆ‘ä»¬æä¾›äº†æ§åˆ¶å°çš„ Demoï¼š

```bash

python cli_demo.py --model openlmlab/open-chinese-llama-7b-patch
                   --devices 0
                   --max_length 1024
                   --do_sample true
                   --top_k 40
                   --top_p 0.8
                   --temperature 0.7
                   --penalty 1.02

```

æ•ˆæœå¦‚å›¾æ‰€ç¤ºï¼š

![Cli Demo](/pics/cli_demo.png "å‘½ä»¤è¡Œ Demo")

## ä¸‹è½½åœ°å€

| æ¥æº      | åœ°å€ |
| ----------- | ----------- |
| ğŸ¤—Huggingface   | [openlmlab/open-chinese-llama-7b-patch](https://huggingface.co/openlmlab/open-chinese-llama-7b-patch)       |
| ç™¾åº¦ç½‘ç›˜       | -        |
| Google Driver | -        |

## æ¨¡å‹æ ¼å¼è½¬æ¢

**Open-Chinese-LLaMA-7B-Patch** ä¸­çš„ `patch_model.py` å·¥å…·å°½å¯è½¬æ¢ä¸º `transformers` å¯åŠ è½½çš„ **hf** æ ¼å¼ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬åŒæ—¶æä¾›äº†å®˜æ–¹ç‰ˆæœ¬æ¨¡å‹ï¼ˆ`raw`ï¼‰åˆ° `hf` çš„è½¬æ¢å·¥å…·ï¼š

æç¤ºï¼Œå½“è½¬æ¢æˆ `raw` æ ¼å¼çš„æ¨¡å‹æ—¶ï¼Œéœ€è¦æŒ‡å®šå¼ é‡å¹¶è¡Œçš„å¤§å°å’Œå¯¹åº”è®¾å¤‡ï¼Œå¹¶ä¸”åªèƒ½åœ¨æ‹¥æœ‰å¯¹åº”æ•°é‡çš„æ˜¾å¡çš„æœºå™¨ä¸Šè½¬æ¢ã€‚

```bash

python convert_model.py --model_path <path_or_name_to_your_hf_or_raw_model>
                        --source_format hf
                        --target_format raw
                        --target_path <path_you_want_to_save_the_converted_model>
                        --raw_parallel_degree 2
                        --raw_parallel_devices 0,1

```
